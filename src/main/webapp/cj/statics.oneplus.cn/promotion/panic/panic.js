function PanicClock(){var a,b,c,d,e,f,g=new Date;if(op.panic.elm.length<=0)return void clearTimeout(op.panic.timerID);if(f=g.getTime()+op.panic.duration,a=op.panic.end-f,0>=a)return clearTimeout(op.panic.timerID),showClock(op.panic.elm,{d:"00",h:"00",m:"00",s:"00"}),!!op.panic.needVer&&showVerCode(),void op.panic.callback.call($("#btn-panic"));b=Math.floor(a/864e5),a-=864e5*b,c=Math.floor(a/36e5),a-=36e5*c,d=Math.floor(a/6e4),a-=6e4*d,e=Math.floor(a/1e3),b=9>=b?"0"+b:b,c=9>=c?"0"+c:c,d=9>=d?"0"+d:d,e=9>=e?"0"+e:e,showClock(op.panic.elm,{d:b,h:c,m:d,s:e});op.panic.timerID=setTimeout("PanicClock()",1e3)}function showClock(a,b){a.find(".dd").html(b.d),a.find(".hh").html(b.h),a.find(".mm").html(b.m),a.find(".ss").html(b.s)}function getDuration(a){return a-(new Date).getTime()}function showVerCode(){$(".p-clockbox .ptitle").hide(),$(".p-clockbox .p-clock").hide(),$(".ver-info .code-img img").attr("src",_GLOBAL_CONFIG.panic.ajaxCode+"?t="+Math.random()),$(".p-clockbox .ver-info").show(),isLogin()&&$("#panic-tip").html("输入验证码 然后点击立即抢购")}function isEmpty(a){return a&&0!==a.length?!1:!0}function getStartTime(){var a;if(op.panic.end){var b=new Date(op.panic.end),c=b.getMinutes();10>c&&(c="0"+c),a=b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate()+" "+b.getHours()+":"+c}op.panic.startTime=a}function stopEvent(a){a.preventDefault(),a.stopPropagation()}var op=op||window.op||{},qqPop=new PopWin({className:"q-tips"});op.panic=op.panic||{},op.panic.duration=0,op.panic.needVer=1,op.panic.mobile=0,op.panic.setSms=0,op.panic.startTime=0,op.panic.nexturl="",op.panic.htmls=['<div class="panic-left wz-fail"></div><div class="panic-right"><div class="panic-text">抱歉，<br/>您没有预约无法参与本轮购买</div><div class="panic-btnbox"><a href="javascript:void(0);" class="btn btn-red btn-panic-m btn-ok">确定</a></div></div>','<div class="panic-left wz-fail"></div><div class="panic-right"><div class="panic-text">抱歉，本轮销售已结束</div><div class="panic-btnbox"><a href="javascript:void(0);" class="btn btn-red btn-panic-m btn-ok">确定</a></div></div>','<div class="panic-left wz-success"></div><div class="panic-right"><div class="panic-text">恭喜您，已经成功下单</div><div class="panic-btnbox"><a href="javascript:void(0);" class="btn btn-red btn-panic-m btn-order1">查看我的订单</a></div></div>','<div class="panic-left wz-fail"></div><div class="panic-right"><div class="panic-text">您的资格已过期</div><div class="panic-btnbox"><a href="javascript:void(0);" class="btn btn-red btn-panic-m btn-ok">确定</a></div></div>','<div class="panic-left wz-success"></div><div class="panic-right"><div class="panic-text">恭喜您获得购买资格，<br/>快去下单吧</div><div class="panic-btnbox"><a href="javascript:void(0);" class="btn btn-red btn-panic-m btn-order2">去下单</a></div></div>','<div class="panic-left wz-fail"></div><div class="panic-right"><div class="panic-text">排队拥挤，请再试一次</div><div class="panic-btnbox"><a href="javascript:void(0);" class="btn btn-red btn-panic-m btn-ok">确定</a></div></div>'],op.panic.str='<div class="panic-left wz-fail"></div><div class="panic-right"><div class="panic-text">抱歉，本轮销售已结束</div><div class="panic-btnbox"><a href="javascript:void(0);" class="btn btn-red btn-panic-m btn-ok">确定</a></div></div>',op.panicform=function(a){return'<form id="form1" action="'+_GLOBAL_CONFIG.panic.order+'"><input type="hidden" name="goodsInfo['+a+'][num]" id="goodsInfo" value="1"><input type="hidden" name="goodsInfo['+a+'][type]" value="1"><input type="hidden" name="goodscode" value="'+a+'"><input type="hidden" name="oilCode" value=""></form>'},op.panic.ajax=function(a){$.ajax({url:a.url,data:a.data||{},type:a.type||"POST",dataType:"jsonp",jsonp:"success_jsonpCallback",jsonpCallback:"success_jsonpCallback"}).done(function(b){"function"==typeof a.callback&&a.callback.call(this,b)}).fail(function(){return a.silent?void 0:void window.pop.alert("服务器正忙！请稍后再试")})},op.panic.init=function(){if(!isLogin())return showLogin(),!1;var a={format:"json"},b=$(".ver-info .ver-code").val();return b=jQuery.trim(b),isEmpty(b)||(a.code=b),op.panic.needVer?isEmpty(b)?($("#panic-tip").html("* 验证码错误，请重新输入"),$(".ver-info .ver-code").addClass("wrong-code"),$(".ver-info .code-btn").addClass("code-clear"),!1):(op.panic.ajax({url:_GLOBAL_CONFIG.panic.ajaxVerify,data:a,callback:function(b){return 1!=b.ret?($("#panic-tip").html("* 验证码错误，请重新输入"),$(".ver-info .ver-code").addClass("wrong-code"),$(".ver-info .code-btn").addClass("code-clear"),$(".ver-info .next-code").click(),!1):($("#panic-tip").addClass("visi-hide"),$(".ver-info .ver-code").removeClass("wrong-code").addClass("right-code"),$(".ver-info .code-btn").removeClass("code-clear"),op.panic.needVer=0,op.panic.getPhone(a),!1)}}),!1):void op.panic.getPhone(a)},op.panic.getPhone=function(a){op.panic.ajax({url:_GLOBAL_CONFIG.panic.panic,data:a,callback:function(a){if(2==a.ret)return $("#panic-tip").removeClass("visi-hide").html("* 验证码错误，请重新输入"),$(".ver-info .ver-code").addClass("wrong-code"),$(".ver-info .code-btn").addClass("code-clear"),$(".ver-info .next-code").click(),op.panic.needVer=1,!1;if(1!=a.ret)return window.pop.alert(a.errMsg),!1;if(0===a.data.isLogin)return showLogin(),!1;switch(op.panic.nexturl=a.data.url||"",a.data.state){case 0:case 1:case 2:case 3:case 5:$("#pop-panic").find(".panic-con").html(op.panic.htmls[a.data.state]),window.pop.showElm("#pop-panic"),1===a.data.state&&$("#btn-panic").removeClass("btn-red").addClass("btn-gray").html("已售罄");break;case 4:case 6:$("#pop-panic").find(".panic-con").html(op.panic.htmls[4]+op.panicform(op.panic.sku)),window.pop.showElm("#pop-panic");break;default:$("#pop-panic").find(".panic-con").html(op.panic.htmls[5]),window.pop.showElm("#pop-panic")}return!1}})},op.doPanic=function(a){return 1!==a.ret?void window.pop.alert(a.errMsg):(op.panic.needVer=a.data.needVerifyCode,op.panic.mobile=a.data.mobile,op.panic.setSms=a.data.setSms,op.panic.end=a.data.timeStart,1===a.data.state?void this.removeClass("btn-red").addClass("btn-gray").html("已售罄"):(0===a.data.time&&this.removeClass("btn-gray").addClass("btn-red").html("立即抢购"),op.panic.sku=a.data.sku||"",op.panic.serverDate=a.data.timeNow,op.panic.duration=getDuration(op.panic.serverDate),op.panic.timerID&&clearTimeout(op.panic.timerID),PanicClock(),void getStartTime()))},op.panic.day=["","星期一","星期二","星期三","星期四","星期五","星期六","星期日"],op.panic.getPanicDate=function(a){this.pdate=new Date(a);var b=this.pdate.getHours(),c="";return b>=0&&6>b?c="凌晨":b>=6&&12>b?c="上午":b>=12&&13>b?c="中午":b>=13&&18>b?c="下午":b>=18&&24>b&&(c="晚上"),this.pdate.getMonth()+1+"月"+this.pdate.getDate()+"日"+op.panic.day[this.pdate.getDay()]+c},op.panic.callback=function(){this.removeClass("btn-gray").addClass("btn-red").html("立即抢购")},$(function(){var a=$(".panic-main");if(a.length>0){var b=$("#panic-date"),c=$(".btn-pd"),d=$(".btn-yy");c.on("click",function(a){return stopEvent(a),isLogin()?void(location.href=_GLOBAL_CONFIG.paiduiUrl):void showLogin()}),d.on("click",function(a){return stopEvent(a),d.hasClass("btn-gray")?void 0:isLogin()?void(location.href=_GLOBAL_CONFIG.yuyueUrl):void showLogin()}),$(".panicbox").on("click",".panic-ul a",function(){if(!isLogin()){var a=$(this).attr("href");return a=_GLOBAL_CONFIG.panic.jumpHead+a,showLogin(a),!1}}),$(".panic-main").on("click",".panic-guize span",function(){var a=$(".buy-rule").html();window.pop.text("活动规则",!0,a,"","","",!0,!1,!0,670,510)}),op.panic.ajax({url:_GLOBAL_CONFIG.panic.index,data:{format:"json"},callback:function(a){return 1!==a.ret?void window.pop.alert(a.errMsg):(b.html(op.panic.getPanicDate(a.data.startTime)),1!==a.data.enableBook?void d.removeClass("btn-red").addClass("btn-gray"):void d.addClass("btn-red").removeClass("btn-gray"))},silent:!0})}var e=$(".c-panic");if(e.length>0){$("#p-pic").bxSlider({mode:"fade",pagerCustom:"#ul-pager",responsive:!0}),$(window).scrollTop($(".c-panic").position().top);var f="#pop-panic",g=$("#pop-panic"),h=$("#btn-panic");$("#panic-tip").find("span").html(isLogin()?"点击刷新准备开抢":'参加活动请先 <a id="btn-login" href="javascript:void(0);">登录</a>'),op.panic.elm=$(".p-clockbox"),$("#panic-tip").on("click","#btn-login",function(){return isLogin()?void 0:(showLogin(),!1)}),$(".ver-info").on("click",".next-code",function(){$(".ver-info .code-img img").attr("src",_GLOBAL_CONFIG.panic.ajaxCode+"?t="+Math.random())}),$(".ver-info").on("click",".code-clear",function(){$(".ver-info .ver-code").val("").removeClass("wrong-code").focus(),$(this).removeClass("code-clear")}),$(".p-clockbox").on("click",".panic-guize",function(){var a=$(".buy-rule").html();window.pop.text("活动规则",!0,a,"","","",!0,!1,!0,670,510)}),$(".re-box").on("click",".re-qq",function(){var a={content:"亲爱的加油，久等啦！一加手机现货今天准时发售，64G专场10：00开抢,请及时前往www.oneplus.cn！",time:op.panic.startTime,advance:15,url:window.location.href,icon:"2_1"},b="http://qzs.qq.com/snsapp/app/bee/widget/open.htm#content="+encodeURIComponent(a.content)+"&time="+encodeURIComponent(a.time)+"&advance="+a.advance+"&url="+encodeURIComponent(a.url),c='<iframe width="580px" height="460px" style="margin-top: -85px;" frameborder="0" scrolling="no" src="'+b+'" allowtransparency="true"></iframe>';qqPop.text("",!0,c,"","","",!1,!1,!0,620,420)}),$(".re-box").on("click",".re-me",function(){if(!isLogin())return showLogin(),!1;var a='<div class="panic-left wz-fail"></div><div class="panic-right"><div class="panic-text sms-text">抱歉，您的账号还未绑定手机号，请<a class="to-user-center" target="_blank" href="'+_GLOBAL_CONFIG.bandMobile+'">点击个人中心</a>绑定并验证之后再设置短信提醒，谢谢！<br />开始时间：'+op.panic.startTime+'</div><div class="panic-btnbox"><a href="javascript:void(0);" class="btn btn-red btn-panic-m btn-ok">确定</a></div></div>';if(!op.panic.mobile)return $("#pop-panic").find(".panic-con").html(a),window.pop.showElm("#pop-panic"),op.panic.mobile="1",!1;var b='<div class="panic-left wz-success"></div><div class="panic-right"><div class="panic-text sms-text">成功设置一加手机现货开售活动短信提醒，默认发至您的绑定手机手机号，届时请关注手机短信！<br />开始时间：'+op.panic.startTime+'</div><div class="panic-btnbox"><a href="javascript:void(0);" class="btn btn-red btn-panic-m btn-ok">确定</a></div></div>';if(op.panic.setSms)return $("#pop-panic").find(".panic-con").html(b),window.pop.showElm("#pop-panic"),!1;var c=new Date,d=c.getTime()+op.panic.duration,e=op.panic.end-d;if(18e5>e){var f='<div class="panic-left wz-fail"></div><div class="panic-right"><div class="panic-text sms-text">活动即将开始，关注页面倒计时比短信提醒更直接！</div><div class="panic-btnbox"><a href="javascript:void(0);" class="btn btn-red btn-panic-m btn-ok">确定</a></div></div>';return $("#pop-panic").find(".panic-con").html(f),window.pop.showElm("#pop-panic"),!1}op.getAjax(_GLOBAL_CONFIG.panic.ajaxSetSmsNotice,{format:"json"},function(c){1==c.ret||400042==c.ret?($("#pop-panic").find(".panic-con").html(b),window.pop.showElm("#pop-panic")):400043==c.ret?($("#pop-panic").find(".panic-con").html(a),window.pop.showElm("#pop-panic")):window.pop.alert(c.errMsg)},function(){window.pop.alert("设置超时，请稍后再试。")})}),$(".as-detail-float ul li a, .as-detail-nav li a").on("click",function(){var a=$(this).attr("href");"#anchor-pic"===a?$(window).scrollTop($(".as-detail-pic").position().top):"#anchor-spec"===a?$(window).scrollTop($(".as-detail-spec").position().top):"#anchor-question"===a&&$(window).scrollTop($(".as-detail-question").position().top)}),$(document).on("click",".to-user-center",function(){$("#pop-panic .btn-ok").click()}),g.on("click",".btn-ok",function(a){stopEvent(a),window.pop.hideElm(f)}),g.on("click",".btn-paidui",function(a){stopEvent(a),window.pop.hideElm(f)}),g.on("click",".btn-saleout",function(a){stopEvent(a),window.pop.hideElm(f)}),g.on("click",".btn-order1",function(a){stopEvent(a),window.pop.hideElm(f),window.open(op.panic.nexturl,"_blank")}),g.on("click",".btn-order2",function(a){stopEvent(a),window.pop.hideElm(f),g.find("#form1").submit()}),$("#btn-refresh").on("click",function(a){stopEvent(a),clearTimeout(op.panic.timerID),op.panic.ajax({url:_GLOBAL_CONFIG.panic.info,data:{format:"json"},callback:function(a){op.doPanic.call(h,a,f)}})}),op.panic.ajax({url:_GLOBAL_CONFIG.panic.info,data:{format:"json"},callback:function(a){op.doPanic.call(h,a,f)},silent:!0}),h.on("click",function(a){stopEvent(a),h.hasClass("btn-gray")||op.panic.init()})}});